#pragma once

#include <string>
#include <map>
#include <vector>

#include <G4PhysicalConstants.hh>
#include <G4SystemOfUnits.hh>

namespace Materials {
namespace Yap {

static const std::string name = "yap";
static const double density = 5.55 * g/cm3;

// relative fractions, not by weight.
// need to be normalized
static const std::map<std::string, double>
fractions = {
    {"Y", 1},
    {"Al", 1},
    {"O", 3},
    {"Ce", 0.005}
};

static const double resolution_scale = 1;
static const double scint_yield = 25 / keV;
static const double decay_time_constant = 28 * ns;

static const std::vector<double> rindex_energies = {
    2.480*eV, 2.755*eV, 3.100*eV, 3.542*eV, 4.133*eV, 4.959*eV, 6.199*eV
};
static const std::vector<double> rindex = {
    1.91, 1.92, 1.92, 1.94, 1.96, 2.02, 2.26
};

static const std::vector<double> scint_intens = {
    1.501e-04, 1.501e-04, 3.752e-05, 0.000e+00, 7.504e-05, 1.501e-04, 1.876e-04, 1.876e-04, 1.876e-04, 
    3.002e-04, 3.377e-04, 2.627e-04, 2.251e-04, 1.876e-04, 1.876e-04, 1.876e-04, 1.876e-04, 1.876e-04, 2.251e-04, 
    2.251e-04, 3.002e-04, 3.002e-04, 3.002e-04, 3.002e-04, 3.752e-04, 4.878e-04, 5.628e-04, 6.754e-04, 9.381e-04, 
    1.126e-03, 1.313e-03, 1.576e-03, 1.876e-03, 2.139e-03, 2.401e-03, 2.664e-03, 2.964e-03, 3.264e-03, 3.452e-03, 
    3.790e-03, 4.015e-03, 4.428e-03, 4.765e-03, 5.103e-03, 5.703e-03, 6.266e-03, 6.867e-03, 7.354e-03, 7.805e-03, 
    8.217e-03, 8.705e-03, 9.193e-03, 9.606e-03, 9.981e-03, 1.032e-02, 1.069e-02, 1.107e-02, 1.186e-02, 1.276e-02, 
    1.415e-02, 1.441e-02, 1.471e-02, 1.512e-02, 1.655e-02, 1.681e-02, 1.711e-02, 1.756e-02, 1.824e-02, 1.887e-02, 
    1.944e-02, 2.011e-02, 2.071e-02, 2.105e-02, 2.139e-02, 2.165e-02, 2.184e-02, 2.184e-02, 2.180e-02, 2.195e-02, 
    2.210e-02, 2.229e-02, 2.229e-02, 2.210e-02, 2.176e-02, 2.139e-02, 2.067e-02, 2.034e-02, 2.004e-02, 1.977e-02, 
    1.959e-02, 1.936e-02, 1.906e-02, 1.884e-02, 1.865e-02, 1.764e-02, 1.643e-02, 1.471e-02, 1.310e-02, 1.167e-02, 
    1.009e-02, 8.555e-03, 7.317e-03, 6.229e-03, 5.103e-03, 3.677e-03, 3.002e-03, 2.289e-03, 1.914e-03, 1.651e-03, 
    1.313e-03, 9.756e-04, 6.379e-04, 4.127e-04, 2.627e-04, 1.876e-04, 1.126e-04, 3.752e-05
};

static const std::vector<double> scint_energies = {
    2.078*eV, 2.089*eV, 2.096*eV, 2.108*eV, 2.118*eV, 2.129*eV, 2.150*eV, 2.198*eV, 2.247*eV, 
    2.293*eV, 2.335*eV, 2.386*eV, 2.435*eV, 2.486*eV, 2.530*eV, 2.569*eV, 2.606*eV, 2.643*eV, 2.663*eV, 
    2.688*eV, 2.713*eV, 2.744*eV, 2.770*eV, 2.797*eV, 2.818*eV, 2.841*eV, 2.860*eV, 2.875*eV, 2.899*eV, 
    2.914*eV, 2.926*eV, 2.949*eV, 2.966*eV, 2.979*eV, 2.995*eV, 3.005*eV, 3.016*eV, 3.024*eV, 3.034*eV, 
    3.053*eV, 3.064*eV, 3.078*eV, 3.086*eV, 3.095*eV, 3.109*eV, 3.114*eV, 3.126*eV, 3.131*eV, 3.134*eV, 
    3.140*eV, 3.146*eV, 3.154*eV, 3.160*eV, 3.169*eV, 3.178*eV, 3.186*eV, 3.198*eV, 3.210*eV, 3.216*eV, 
    3.219*eV, 3.228*eV, 3.247*eV, 3.253*eV, 3.259*eV, 3.278*eV, 3.290*eV, 3.296*eV, 3.306*eV, 3.315*eV, 
    3.325*eV, 3.338*eV, 3.351*eV, 3.364*eV, 3.377*eV, 3.391*eV, 3.401*eV, 3.421*eV, 3.435*eV, 3.452*eV, 
    3.462*eV, 3.476*eV, 3.498*eV, 3.508*eV, 3.519*eV, 3.530*eV, 3.541*eV, 3.556*eV, 3.563*eV, 3.574*eV, 
    3.585*eV, 3.597*eV, 3.612*eV, 3.627*eV, 3.638*eV, 3.650*eV, 3.666*eV, 3.673*eV, 3.689*eV, 3.705*eV, 
    3.721*eV, 3.737*eV, 3.750*eV, 3.762*eV, 3.783*eV, 3.791*eV, 3.799*eV, 3.812*eV, 3.820*eV, 3.833*eV, 
    3.855*eV, 3.872*eV, 3.894*eV, 3.916*eV, 3.939*eV, 3.957*eV, 3.984*eV, 4.008*eV
};

// From https://doi.org/10.1016/S0168-9002(97)01181-9
const std::vector<double> abs_len_energies = {
    1.766*eV, 1.803*eV, 1.841*eV, 1.881*eV, 1.923*eV,
    1.967*eV, 2.012*eV, 2.060*eV, 2.110*eV, 2.163*eV,
    2.218*eV, 2.276*eV, 2.337*eV, 2.402*eV, 2.471*eV,
    2.543*eV, 2.620*eV, 2.702*eV, 2.789*eV, 2.881*eV,
    2.980*eV, 3.086*eV, 3.200*eV, 3.258*eV, 3.323*eV,
    3.425*eV, 3.488*eV, 3.540*eV, 3.587*eV, 3.622*eV,
    3.650*eV, 3.679*eV, 3.705*eV, 3.805*eV , 6*eV
};
const std::vector<double> abs_len = {
    26.717*cm, 25.440*cm, 24.212*cm, 23.299*cm, 22.411*cm,
    21.824*cm, 21.496*cm, 21.120*cm, 20.908*cm, 21.079*cm,
    21.100*cm, 20.895*cm, 20.232*cm, 19.365*cm, 18.081*cm,
    17.152*cm, 16.565*cm, 16.333*cm, 16.906*cm, 17.473*cm,
    17.651*cm, 16.975*cm, 15.677*cm, 15.363*cm, 14.876*cm,
    13.233*cm, 11.518*cm, 9.846*cm, 8.012*cm, 6.184*cm,
    4.456*cm, 2.728*cm, 1.344*cm, 0.112*cm, 0.01*cm
};
}
}